<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <title>Тренажер для закупок</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- <script src="https://use.fontawesome.com/99a9553d81.js"></script> -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/v4-shims.min.js"
    integrity="sha384-/OZ1Lht4J1/FfstamqqFX1tF7PkDWDKbvat1bkWByC2KRJwGzm/H2bVuw8N4SD8y"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/brands.min.js"
    integrity="sha384-KASsDRWwlErb8dTf+e5TxRXMnbXrVlbPbn1hS5B/yS4vNsF7mHHO+Gw1bBDhcyOt"
    crossorigin="anonymous"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/conflict-detection.min.js"
    integrity="sha384-fHnSzPZE3xYvvXY0y51vln9J+Jd0eK4HughCkcA0NsBpmAGgU97n65RbDqUgnWf1"
    crossorigin="anonymous"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/fontawesome.min.js"
    integrity="sha384-H4naMsxnUrIT8qihjWfwIKXi5biIYnqUsQ+vIJGZIKfA+7/O3FxgvMrdH77X+aID"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/regular.min.js"
    integrity="sha384-yUk5aOIIy62R2bRFbFq0+bo+ChWYs75cusETAJ1KYvEMRiEbQZmNU6u+PK60t536"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/solid.min.js"
    integrity="sha384-OSCcNUu98kEBVxq0vZaBr0wdmmd2ojuJwvWuSRKD0V10PWmvTetja8mxGfZm5PsV"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/v4-shims.min.js"
    integrity="sha384-/OZ1Lht4J1/FfstamqqFX1tF7PkDWDKbvat1bkWByC2KRJwGzm/H2bVuw8N4SD8y"
    crossorigin="anonymous"></script>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <style>
    /* .container-fluid {
      padding-left: 40px;
      padding-right: 40px;
    } */
    /* .table-responsive {
      padding-left: 160px;
      padding-right: 160px;
      padding-bottom: 40px;
    }    */
    p.lead {
      padding-left: 15px;

    }

    div.container {
      max-width: 100%;
      padding-bottom: 80px;
    }

    .pt-3-half {
      padding-top: 1.4rem;
    }

    .custom-range::-webkit-slider-thumb {
      background: yellow;
    }


    /*шапка*/
    header {
      height: 150px;
    }

    /*фиксированное плавающее меню*/
    #top_nav {
      top: 0px;
      /*высота шапки в пикселях*/
      position: fixed;
      z-index: 200;
    }

    /*фиксированное плавающее меню*/
    #top_buttons {
      top: 150px;
      /*высота шапки в пикселях*/
      position: fixed;
      z-index: 200;
    }

    div.dic-economy {
      padding-left: 30px;

    }

    /* .container{
    max-width: 100%;
} */
  </style>
</head>

<body>



  <div class="container-fluid">







    <!-- Конец джумботрона -->
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-4" id="top_nav">
          <div class="dic-economy">
            <h4 class="card-header text-center font-weight-bold text-uppercase py-4">
              <div class="input-group  mb">
                <div class="input-group-prepend">
                  <span class="input-group-text font-weight-bold text-success" id="top_economy">Экономия: </span>
                </div>
                <span type="text-md" class="form-control w-25" id="economy" value="2 000 000 000">2 000 000
                  000</span>

              </div>

            </h4>

          </div>
        </div>
        <div class="col-md-6"></div>
        <div class="btn-group-vertical" id="top_buttons">

          <button class="btn btn-primary scroll-to-table">1</button>
          <button class="btn btn-danger scroll-to-table">2</button>
          <button class="btn btn-primary scroll-to-table">3</button>
          <button class="btn btn-primary scroll-to-table">4</button>
          <button class="btn btn-primary scroll-to-table">5</button>
          <button class="btn btn-primary scroll-to-table">6</button>
          <button class="btn btn-primary scroll-to-table">7</button>
          <button class="btn btn-primary scroll-to-table">8</button>

          <span class="table-add float-center mb-3 mr-2"><a href="#!" class="text-primary"><i
            class="fas fa-plus fa-1x" aria-hidden="true"></i></a></span>
     
        </div>
      </div>
      <div class="col-md-12">

        <div class="container">

          <!-- Editable table -->
          <div class="card">

            <h3 class="card-header text-center font-weight-bold text-uppercase py-4">Набор 1
            </h3>
            <div class="card-body">
              <div id="table" class="table-editable">

                <span class="table-add float-right mb-3 mr-2"><a href="#!" class="text-success"><i
                      class="fas fa-plus fa-2x" aria-hidden="true"></i></a></span>
                <table class="table table-sm table-bordered table-responsive-md table-striped text-center" id="table1">
                  <thead>
                    <tr>
                      <th class="text-center" style="width: 12%">Реестровый №</th>
                      <th class="text-center" style="width: 12%">Начальная цена</th>
                      <th class="text-center" style="width: 20%">Лимит снижения, %</th>
                      <th class="text-center" style="width: 12%">Лимит снижения, руб.</th>
                      <th class="text-center" style="width: 12%">Итоговое снижение, %</th>
                      <th class="text-center" style="width: 18%">Итоговое снижение, руб.</th>
                      <th class="text-center" style="width: 12%">Экономия, руб.</th>
                      <th class="text-center" style="width: 12%">Ответственный за лимит</th>
                      <th class="text-center" style="width: 6%">Порядок</th>
                      <th class="text-center">Удалить</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="pt-3-half" contenteditable="true">0372200004520000084</td>
                      <td class="pt-3-half" contenteditable="true">2016242676.00</td>
                      <td class="pt-3-half">
                        <input type="text" class="form-control" value="0">
                        <input type="range" class="custom-range" value="0" min="0" max="100" step="0.5"
                          id="customRange1" oninput="changeOffer(this)"></td>
                      <td class="pt-3-half" contenteditable="true">0</td>
                      <td class="pt-3-half" contenteditable="true"></td>
                      <td class="pt-3-half">

                      </td>
                      <td class="pt-3-half">

                      </td>
                      <td class="pt-3-half">
                        Иванов Иван Иванович
                      </td>
                      <td class="pt-3-half">
                        <span class="table-up"><a href="#!" class="indigo-text"><i class="fas fa-long-arrow-alt-up"
                              aria-hidden="true"></i></a></span>
                        <span class="table-down"><a href="#!" class="indigo-text"><i class="fas fa-long-arrow-alt-down"
                              aria-hidden="true"></i></a></span>
                      </td>
                      <td>
                        <span class="table-remove"><button type="button"
                            class="btn btn-danger btn-rounded btn-sm my-0">Remove</button></span>
                      </td>
                    </tr>
                    <!-- This is our clonable table line -->
                    <tr>
                      <td class="pt-3-half" contenteditable="true">0372200004520000217</td>
                      <td class="pt-3-half" contenteditable="true">2115062184.29</td>
                      <td class="pt-3-half">
                        <input type="text" class="form-control" value="0">
                        <input type="range" class="custom-range" value="0" min="0" max="100" step="0.5"
                          id="customRange1" oninput="changeOffer(this)"></td>
                      </td>
                      <td class="pt-3-half" contenteditable="true">0</td>
                      <td class="pt-3-half" contenteditable="true"></td>
                      <td class="pt-3-half">

                      </td>
                      <td class="pt-3-half">

                      </td>
                      <td class="pt-3-half">
                        Петров Петр Петрович
                      </td>
                      <td class="pt-3-half">
                        <span class="table-up"><a href="#!" class="indigo-text"><i class="fas fa-long-arrow-alt-up"
                              aria-hidden="true"></i></a></span>
                        <span class="table-down"><a href="#!" class="indigo-text"><i class="fas fa-long-arrow-alt-down"
                              aria-hidden="true"></i></a></span>
                      </td>
                      <td>
                        <span class="table-remove"><button type="button"
                            class="btn btn-danger btn-rounded btn-sm my-0">Удалить</button></span>
                      </td>
                    </tr>




                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <!-- Editable table -->

        </div>
      </div>
    </div>


  </div>










  <div id="memo" class="modal fade" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Памятка</h4>
          <button class="close" data-dismiss="modal">x</button>
        </div>
        <div class="modal-body">
          <div><span class="font-weight-bold">1) Зависание комьютера:</span> перезагрузить вкладку браузера, если не
            получается - перезагрузить компьютер.
          </div>
          <div><span class="font-weight-bold">2) Отключение интернета:</span> сменить источник интернета. </div>
          <div><span class="font-weight-bold">3) Отключение площадки:</span> взять телефон и начать снимать видео,
            на
            котором у Вас не работает площадка,
            затем Вы открываете <a href="https://www.google.com">любой сайт</a>, чтобы показать, что интернет есть,
            после чего авторизуетесь на площадке
            <a href="https://login.sberbank-ast.ru/Login.aspx">Сбербанк-АСТ (вход через ЕСИА)</a>, чтобы показать,
            что компьютер настроен правильно.</div>
          <div><span class="font-weight-bold">4) Не подается предложение:</span> взять телефон и начать снимать
            видео, на котором у Вас работает площадка,
            но не подается предложение,
            затем Вы открываете <a href="https://www.google.com">любой сайт</a>, чтобы показать, что интернет есть,
            после чего авторизуетесь на площадке
            <a href="https://login.sberbank-ast.ru/Login.aspx">Сбербанк-АСТ (вход через ЕСИА)</a>, чтобы показать,
            что компьютер настроен правильно.</div>
          <div class="modal-footer">
            <div lass="btn-group btn-group-justified" role="group">
              <div class="btn-group col-md-12" data-toggle="buttons">
                <button class="btn btn-primary" data-dismiss="modal">OK</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>


  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css" crossorigin="anonymous"></script> -->

  <!-- <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap.min.css"> -->
  <!-- <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script> -->



  <!-- 
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">

  <script type="text/javascript" charset="utf8"
    src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" charset="utf8"
    src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
  <script type="text/javascript" charset="utf8"
    src="https://cdn.datatables.net/plug-ins/1.10.20/sorting/signed-num.js"></script> -->





  <!-- <script>$(document).ready(function () {
      $('#example').DataTable({
        columnDefs: [
          { type: 'signed-num', targets: 0 }
        ]
      });
    });
    </script> -->
  <!-- <script>
    youCanGoToAuction = true
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    $('a').on('click', function (e) {
      if (getRandomInt(1, 10) > 7 || !youCanGoToAuction) {
        youCanGoToAuction = false
        e.stopPropagation();
        e.preventDefault();
      }
    })

  </script> -->
  <script>
    economyValue = 2000000000
    var economyAccumulator
    function roundUp(num, precision) {
      precision = Math.pow(10, precision)
      return Math.ceil(num * precision) / precision
    }
    function localeString(x, sep, grp) {
      var sx = ('' + x).split('.'), s = '', i, j;
      sep || (sep = ' '); // default seperator
      grp || grp === 0 || (grp = 3); // default grouping
      i = sx[0].length;
      while (i > grp) {
        j = i - grp;
        s = sep + sx[0].slice(j, i) + s;
        i = j;
      }
      s = sx[0].slice(0, i) + s;
      sx[0] = s;
      return sx.join('.');
    }
    const $tableID = $('#table');
    const $BTN = $('#export-btn');
    const $EXPORT = $('#export');

    const newTr = `
<tr class="hide">
  <td class="pt-3-half" contenteditable="true">Example</td>
  <td class="pt-3-half" contenteditable="true">Example</td>
  <td class="pt-3-half" contenteditable="true">Example</td>
  <td class="pt-3-half" contenteditable="true">Example</td>
  <td class="pt-3-half" contenteditable="true">Example</td>
  <td class="pt-3-half">
    <span class="table-up"><a href="#!" class="indigo-text"><i class="fas fa-long-arrow-alt-up" aria-hidden="true"></i></a></span>
    <span class="table-down"><a href="#!" class="indigo-text"><i class="fas fa-long-arrow-alt-down" aria-hidden="true"></i></a></span>
  </td>
  <td>
    <span class="table-remove"><button type="button" class="btn btn-danger btn-rounded btn-sm my-0 waves-effect waves-light">Remove</button></span>
  </td>
</tr>`;

    // $('.table-add').on('click', 'i', () => {
    $('.table-add').on('click', function (e) {
      // const $clone = $tableID.find('tbody tr').last().clone(true).removeClass('hide table-line');

      // if ($tableID.find('tbody tr').length === 0) {

      //   $('tbody').append(newTr);
      // }

      // $tableID.find('table').append($clone);
      var tr = '<tr>\
          <th scope="row">'+ 0372200004520000372 + '</th>\
          <td>' + 2058973825.39 + '</td>\
          <td>'+ 0 + '</td>\
          <td>'+ 'Федоров Федор Федорович' + '</td>\
          </tr>';
      $('#table1').append(tr);

    });

    $tableID.on('click', '.table-remove', function () {

      $(this).parents('tr').detach();
    });

    $tableID.on('click', '.table-up', function () {

      const $row = $(this).parents('tr');

      if ($row.index() === 1) {
        return;
      }

      $row.prev().before($row.get(0));
    });

    $tableID.on('click', '.table-down', function () {

      const $row = $(this).parents('tr');
      $row.next().after($row.get(0));
    });

    // A few jQuery helpers for exporting only
    jQuery.fn.pop = [].pop;
    jQuery.fn.shift = [].shift;

    $BTN.on('click', () => {

      const $rows = $tableID.find('tr:not(:hidden)');
      const headers = [];
      const data = [];

      // Get the headers (add special header logic here)
      $($rows.shift()).find('th:not(:empty)').each(function () {

        headers.push($(this).text().toLowerCase());
      });

      // Turn all existing rows into a loopable array
      $rows.each(function () {
        const $td = $(this).find('td');
        const h = {};

        // Use the headers from earlier to name our hash keys
        headers.forEach((header, i) => {

          h[header] = $td.eq(i).text();
        });

        data.push(h);
      });

      // Output the result
      $EXPORT.text(JSON.stringify(data));
    });
    var rangeEl
    var priceFall
    function changeOffer(that) {
      
      if (that.value < Number($("input.custom-range")[0].value)){
        that.value = Number($("input.custom-range")[0].value)
      }
      rangeEl = that
      console.log(rangeEl)
      $(that).closest(':has("input.custom-range")').find('input.form-control')[0].value = that.value
      priceFall = rangeEl.value * Number($(rangeEl).closest(':has(".pt-3-half")').find('.pt-3-half')[1].innerText.replace(/[^0-9.]/g, "")) / 100
      $(rangeEl).closest(':has(".pt-3-half")').find('.pt-3-half')[3].innerText = priceFall
      console.log(rangeEl.value - Number($("input.custom-range")[0].value))
      priceFallMinusGlobalFall = (rangeEl.value - Number($("input.custom-range")[0].value)) * Number($(rangeEl).closest(':has(".pt-3-half")').find('.pt-3-half')[1].innerText.replace(/[^0-9.]/g, "")) / 100
  
      $('#economy')[0].innerText = localeString(economyValue - priceFallMinusGlobalFall)
      //economyValue = economyValue - priceFallMinusGlobalFall
    }
    function changeAllOffers(that) {
      rangeEl = that
      $(that).closest(':has("input.custom-range")').find('input.form-control')[0].value = that.value
      customLength = $("input.custom-range").length
      for (let i = 1; i <= customLength - 1; i++) {
        $("input.custom-range")[i].value = that.value
        $($("input.custom-range")[i]).closest(':has("input.custom-range")').find('input.form-control')[0].value = that.value
        priceFall = $("input.custom-range")[i].value * Number($($("input.custom-range")[i]).closest(':has(".pt-3-half")').find('.pt-3-half')[1].innerText.replace(/[^0-9.]/g, "")) / 100
        $($("input.custom-range")[i]).closest(':has(".pt-3-half")').find('.pt-3-half')[3].innerText = roundUp(priceFall,2)
      }
      economyValue = 2000000000
      $('#economy')[0].innerText = localeString(2000000000)
      // priceFall = rangeEl.value * Number($(rangeEl).closest(':has(".pt-3-half")').find('.pt-3-half')[1].innerText.replace(/[^0-9.]/g, "")) / 100
      // $(rangeEl).closest(':has(".pt-3-half")').find('.pt-3-half')[3].innerText = priceFall

      // $('#economy')[0].innerText = localeString(Number(economyValue.replace(/[^0-9.]/g, "")) - priceFall)
    }



  </script>

  <script>
    var h_hght = 0; // высота шапки
    var h_mrg = 0;    // отступ когда шапка уже не видна

    var h_hghtButtons = 150; // высота шапки
    var h_mrgButtons = 150;    // отступ когда шапка уже не видна

    $(function () {

      var elem = $('#top_nav');
      var top = $(this).scrollTop();

      if (top > h_hght) {
        elem.css('top', h_mrg);
      }

      $(window).scroll(function () {
        top = $(this).scrollTop();

        // if (top + h_mrg < h_hght) {
        //   elem.css('top', (h_hght - top));
        // } else {
        elem.css('top', h_mrg);
        // }
      });

    });
    $(function () {

      var elem = $('#top_buttons');
      var top = $(this).scrollTop();

      if (top > h_hghtButtons) {
        elem.css('top', h_mrgButtons);
      }

      $(window).scroll(function () {
        top = $(this).scrollTop();

        if (top + h_mrgButtons < h_hghtButtons) {
          elem.css('top', (h_hghtButtons - top));
        } else {
          elem.css('top', h_mrgButtons);
        }
      });

    });



  </script>
  <script>
    var elToSc
    $('.btn.scroll-to-table').on('click', function (e) {
      elToSc = e
      targetEl = elToSc.target.innerText
      elemToScrol = $('h3:contains(' + elToSc.target.innerText + ')')[0]
      $(elemToScrol).get(0).scrollIntoView();
  
    });

 
  </script>

</body>

<nav class="navbar fixed-bottom navbar-dark bg-dark">
  <a class="navbar-brand" href="#">Разработчик: Ермешев Марат, АО "Третий парк", +7(921)425-11-79</a>
</nav>

</html>